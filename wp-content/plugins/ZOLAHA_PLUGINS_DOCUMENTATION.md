# Zolaha Plugins Ecosystem - Developer Documentation

**Date:** January 10, 2026  
**Author:** Antigravity (Google DeepMind) for Zolaha.com  
**Version:** 2.0 (Production Ready)

---

## 1. Ecosystem Overview

This suite consists of three interconnected plugins designed to manage financial data (IPOs and Buybacks) for Zolaha.com. The plugins share a common "Premium" architectural pattern and design system.

### The Stack
-   **Architecture:** Modular Class-Based (Loader, Admin, Fetcher, API).
-   **UI:** SaaS-style Layout with Violet/Blue accents, Card based stats, and Toast notifications.
-   **API:** REST API with Key Authentication and Caching.
-   **Automation:** WP Cron for scheduled scraping.

![Architecture Diagram](https://mermaid.ink/img/pako:eNptkE1rwzAMhv9KoFMM9gN62mF0o5fSjr3sELxGjWPE9kO2Ukr_fXISd9vBQST9ePUq0jFaa4Qc9P3uF625fmgMffT2zaRk8-mC0_mcLpfsfM1I8hTS5ZzR5ZKdz9n5kmZ0yT4fP1_4H1-J99-7t91u9_FwPBy-3o_H3eunw2H__vf2Z7Pdbj8_drvd1_v9_ng8Hl-_j8f967fDYf9W-G_A9wGjN1wY5bTUgA3UoA1UYE1UoQxS0YwK04IK14QqaEI1KoQaVEMtKoc6VEc9KocGVEcjKocWVEcjKocO1KiIyrGCetxAJdSCHmgg77iH8tBC3ukA5VBD3msP5VCD3nMH5VCDPm4P5VBD3msP5VCDPm4P5dB_A98F7P8B9l5D3msPeq8h772GvNce9F5D3nsNea8h772GvPca8t5r0HsNea8h772GvPca8t5ryHuvIe-9hrz3GvLea8h7ryHvvYa89xry3mvIe6-h_w38FvAfX_8B_Ac)

---

## 2. Plugins Breakdown

### A. Buyback Manager (`buyback-manager`)
**Purpose:** Manage Share Buyback data.  
**Key Class:** `BBM_Scraper` (Scrapes current buybacks), `BBM_Admin` (UI), `BBM_API`.

*   **API Endpoint:** `GET /wp-json/zolaha/v1/buybacks`
*   **Security:** Uses `bbm_api_key`.
*   **Features:**
    *   Manual & Cron Fetching.
    *   One-click API Key protection.
    *   Admin Dashboard with pagination.

### B. IPO Master Admin (`ipo-master-admin`)
**Purpose:** The central database for all Mainboard & SME IPOs.  
**Key Class:** `IPOM_Fetcher` (Fetches master list), `IPOM_Admin` (UI), `IPOM_API`.

*   **API Endpoint:** `GET /wp-json/zolaha/v1/ipos`
*   **Parameters:** `?type=sme|main`, `?status=open|upcoming`.
*   **Security:** Uses `ipom_api_key`.
*   **Unique Features:**
    *   Status Filters (Open, Closed, Upcoming).
    *   Company Logo/Icon display.
    *   Grey Market Premium (GMP) highlighting.

### C. IPO Master Details (`ipo-master-details`)
**Purpose:** Deep analytics scraper. Fetches huge JSON blobs for specific IPOs.  
**Dependencies:** Requires `IPO Master Admin` tables to know *what* to fetch.

*   **API Endpoint:** `GET /wp-json/zolaha/v1/details?id={id}`
*   **Smart Fetch Logic:**
    *   **Open IPOs:** Checked every hour.
    *   **Upcoming IPOs:** Checked every 24 hours.
    *   **Closed IPOs:** Ignored to save resources.
*   **Data Points:** RHP PDF Links, Subscription Demand (QIB/NII/Retail), Application-wise breakup, Peer Comparison.

---

## 3. How to Use & Maintain

### 1. API Keys
All plugins now use a persistent API Key system stored in `wp_options`.
-   **Location:** The key is visible in the **Header** of each plugin's Admin Dashboard.
-   **Usage:** Pass it in the header `X-Api-Key` when calling the REST API.
-   **Regeneration:** Keys are generated once on activation. To reset, delete the option `ipom_api_key` (or equivalent) in the DB and deactivate/reactivate the plugin.

### 2. Cron Jobs
Review cron jobs using a plugin like *WP Crontrol* if needed, but they are auto-scheduled:
-   `ipom_hourly_event` (Master List)
-   `ipodetails_hourly_event` (Detailed Scraper)
-   `bbm_hourly_event` (Buybacks)

### 3. Manual Fetching
Each dashboard has a **"Fetch Now"** button in the top right. Use this during testing or if you need immediate data updates without waiting for the Cron.

### 4. Customizing UI
Styles are located in `assets/css/admin-style.css`.
-   **Colors:** Defined as CSS Variables (`--ipom-primary`, `--ipom-surface`, etc.) at the top of the file. Change these to rebrand the entire panel instantly.

---

## 4. File Structure (Standardized)

Each plugin follows this exact structure:

```
plugin-name/
├── plugin-name.php       # Loader (Constants, DB Creation, Cron)
├── admin/
│   └── class-plugin-admin.php  # Dashboard UI & Menu
├── includes/
│   ├── class-plugin-api.php    # REST API Logic
│   └── class-plugin-fetcher.php # Scraper/Fetcher Logic
└── assets/
    └── css/
        └── admin-style.css     # Premium Styles
```

## 5. Troubleshooting

-   **"Undefined Variable" Warnings:** Ensure you are running the latest version of the code (Project has been lint-checked).
-   **Data Not Updating:** Check the "Last Updated" timestamp in the Dashboard header. If it's old, try the "Fetch Now" button. if that works, your Cron system might be disabled in WP (check `DISABLE_WP_CRON` in `wp-config.php`).
-   **API 403 Forbidden:** Ensure you are using the correct API Key. Click the "Copy" icon in the dashboard to be sure.

---
*Generated by Antigravity AI*
